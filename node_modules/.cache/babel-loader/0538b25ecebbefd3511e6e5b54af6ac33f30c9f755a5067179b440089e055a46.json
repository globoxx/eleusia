{"ast":null,"code":"import _toConsumableArray from\"C:/Users/vince/OneDrive/Documents/GitHub/eleusia/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/vince/OneDrive/Documents/GitHub/eleusia/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Button from'@mui/material/Button';import Image from'mui-image';import React,{useState}from'react';import{useEffect}from'react';import ImagesContainer from'./ImagesContainer';import UsersTable from'./UsersTable';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function GameBoard(_ref){var socket=_ref.socket,pseudo=_ref.pseudo,room=_ref.room;var _useState=useState(),_useState2=_slicedToArray(_useState,2),roomData=_useState2[0],setRoomData=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),counter=_useState4[0],setCounter=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),timer=_useState6[0],setTimer=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),waitOnCreator=_useState8[0],setWaitOnCreator=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),currentImage=_useState10[0],setCurrentImage=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),votingDisabled=_useState12[0],setVotingDisabled=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),acceptedImages=_useState14[0],setAcceptedImages=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),refusedImages=_useState16[0],setRefusedImages=_useState16[1];var isRoomCreator=roomData?pseudo===roomData.creator:false;var message=isRoomCreator?\"Bienvenue Ô créateur\":\"Hey t'es un simple joueur\";var handleClickIncreaseCounter=function handleClickIncreaseCounter(){};var handleClickStartGame=function handleClickStartGame(){socket.emit('startGame',room);};var handleVote=function handleVote(decision){socket.emit('vote',room,pseudo,decision);setVotingDisabled(true);if(decision===\"Accept\"){setAcceptedImages([].concat(_toConsumableArray(acceptedImages),[currentImage]));}else{setRefusedImages([].concat(_toConsumableArray(refusedImages),[currentImage]));}setCurrentImage('');};var handleClickRefuse=function handleClickRefuse(){return handleVote('Refuse');};var handleClickAccept=function handleClickAccept(){return handleVote('Accept');};useEffect(function(){socket.on('counter',function(counter){setCounter(counter);});socket.on('updateData',function(data){setRoomData(data);});socket.on('timer',function(timer){if(!waitOnCreator){setTimer(timer);}else{setTimer(\"LE MAÎTRE DU JEU DOIT JOUER\");}});socket.on('newRound',function(image){setCurrentImage(image);setVotingDisabled(false);setWaitOnCreator(false);});socket.on('waitCreator',function(){setWaitOnCreator(true);});},[socket,waitOnCreator]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Room \",room]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Counter: \",counter]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Score: \",roomData?roomData.users[pseudo].score:0]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleClickIncreaseCounter,children:\"Increase counter\"}),/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Timer: \",timer]}),isRoomCreator&&roomData&&!roomData.has_started?/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleClickStartGame,children:\"Start game\"}):null,roomData?/*#__PURE__*/_jsx(UsersTable,{users:roomData.users}):null,currentImage?/*#__PURE__*/_jsx(Image,{src:currentImage,width:500}):null,/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleClickRefuse,disabled:votingDisabled,children:\"Refuser\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleClickAccept,disabled:votingDisabled,children:\"Accepter\"}),/*#__PURE__*/_jsx(ImagesContainer,{images:acceptedImages,category:\"Accepté\"}),/*#__PURE__*/_jsx(ImagesContainer,{images:refusedImages,category:\"Accepté\"})]});}export default GameBoard;","map":{"version":3,"names":["Button","Image","React","useState","useEffect","ImagesContainer","UsersTable","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","GameBoard","_ref","socket","pseudo","room","_useState","_useState2","_slicedToArray","roomData","setRoomData","_useState3","_useState4","counter","setCounter","_useState5","_useState6","timer","setTimer","_useState7","_useState8","waitOnCreator","setWaitOnCreator","_useState9","_useState10","currentImage","setCurrentImage","_useState11","_useState12","votingDisabled","setVotingDisabled","_useState13","_useState14","acceptedImages","setAcceptedImages","_useState15","_useState16","refusedImages","setRefusedImages","isRoomCreator","creator","message","handleClickIncreaseCounter","handleClickStartGame","emit","handleVote","decision","concat","_toConsumableArray","handleClickRefuse","handleClickAccept","on","data","image","children","users","score","variant","onClick","has_started","src","width","disabled","images","category"],"sources":["C:/Users/vince/OneDrive/Documents/GitHub/eleusia/src/components/GameBoard.tsx"],"sourcesContent":["import Button from '@mui/material/Button';\r\nimport Image from 'mui-image'\r\nimport React, { useState } from 'react';\r\nimport { useEffect } from 'react';\r\nimport { Socket } from 'socket.io-client';\r\nimport { RoomData } from '../../server';\r\nimport ImagesContainer from './ImagesContainer';\r\nimport UsersTable from './UsersTable';\r\n\r\nfunction GameBoard({socket, pseudo, room}: {socket: Socket, pseudo: string, room: string}) {\r\n\r\n    const [roomData, setRoomData] = useState<RoomData>()\r\n    const [counter, setCounter] = useState<number>(0)\r\n    const [timer, setTimer] = useState<number | string>(0)\r\n    const [waitOnCreator, setWaitOnCreator] = useState(false)\r\n    const [currentImage, setCurrentImage] = useState('')\r\n    const [votingDisabled, setVotingDisabled] = useState(true)\r\n    const [acceptedImages, setAcceptedImages] = useState<string[]>([])\r\n    const [refusedImages, setRefusedImages] = useState<string[]>([])\r\n\r\n    const isRoomCreator = roomData ? pseudo === roomData.creator : false\r\n    const message = isRoomCreator ? \"Bienvenue Ô créateur\" : \"Hey t'es un simple joueur\"\r\n\r\n    const handleClickIncreaseCounter = () => {\r\n\r\n    }\r\n\r\n    const handleClickStartGame = () => {\r\n        socket.emit('startGame', room)\r\n    }\r\n\r\n    const handleVote = (decision: string) => {\r\n        socket.emit('vote', room, pseudo, decision);\r\n        \r\n        setVotingDisabled(true)\r\n\r\n        if (decision === \"Accept\") {\r\n            setAcceptedImages([...acceptedImages, currentImage])\r\n        } else {\r\n            setRefusedImages([...refusedImages, currentImage])\r\n        }\r\n\r\n        setCurrentImage('')\r\n    }\r\n\r\n    const handleClickRefuse = () => handleVote('Refuse')\r\n    const handleClickAccept = () => handleVote('Accept')\r\n\r\n    useEffect(()=>{\r\n        socket.on('counter', (counter: number) => {\r\n            setCounter(counter)\r\n        });\r\n\r\n        socket.on('updateData', (data: RoomData) => {\r\n            setRoomData(data)\r\n        });\r\n    \r\n        socket.on('timer', (timer: number) => {\r\n            if (!waitOnCreator) {\r\n                setTimer(timer)\r\n            } else {\r\n                setTimer(\"LE MAÎTRE DU JEU DOIT JOUER\")\r\n            }\r\n        });\r\n    \r\n        socket.on('newRound', (image: string) => {\r\n            setCurrentImage(image)\r\n\r\n            setVotingDisabled(false)\r\n\r\n            setWaitOnCreator(false)\r\n        });\r\n\r\n        socket.on('waitCreator', () => {\r\n            setWaitOnCreator(true)\r\n        });\r\n    },[socket, waitOnCreator])\r\n\r\n    return (\r\n        <>\r\n        <h1>Room {room}</h1>\r\n        <p>Counter: {counter}</p>\r\n        <p>Score: {roomData ? roomData.users[pseudo].score : 0}</p> \r\n        <Button variant=\"contained\" onClick={handleClickIncreaseCounter}>Increase counter</Button>\r\n        <p>{message}</p>\r\n\r\n        <p>Timer: {timer}</p>\r\n\r\n        {isRoomCreator && roomData && !roomData.has_started ?\r\n            <Button variant=\"contained\" onClick={handleClickStartGame}>Start game</Button>\r\n            : null\r\n        }\r\n\r\n        {roomData ? <UsersTable users={roomData.users} /> : null}\r\n        \r\n        {currentImage ? <Image src={currentImage} width={500} /> : null}\r\n\r\n        <Button variant=\"contained\" onClick={handleClickRefuse} disabled={votingDisabled}>Refuser</Button>\r\n        <Button variant=\"contained\" onClick={handleClickAccept} disabled={votingDisabled}>Accepter</Button>\r\n        \r\n        <ImagesContainer images={acceptedImages} category={\"Accepté\"}/>\r\n\r\n        <ImagesContainer images={refusedImages} category={\"Accepté\"}/>\r\n\r\n        </>\r\n    )\r\n}\r\n\r\nexport default GameBoard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}